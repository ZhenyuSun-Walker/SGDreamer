Optimizing
Output folder: ./output/bathroom
Reading camera 20/20
[1, 11]
655360 points
Loading Training Cameras
Loading Test Cameras
Loading GT Cameras
Number of points at initialisation :  655360
viewpoint_stack: [Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera()]
viewpoint_stack_gt: [Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera(), Camera()]
Training progress:  10%|█████████▏                                                                                  | 500/5000 [01:47<14:02,  5.34it/s, Loss=0.0214265]/home/sunzhenyu/Projects/MVGS/train.py:551: MatplotlibDeprecationWarning: The tostring_rgb function was deprecated in Matplotlib 3.8 and will be removed in 3.10. Use buffer_rgba instead.
ATE tensor(1.1655e-16, dtype=torch.float64)
  image_from_plot = np.frombuffer(fig.canvas.tostring_rgb(), dtype=np.uint8)
/home/sunzhenyu/anaconda3/envs/mvgs/lib/python3.9/site-packages/torchvision/models/_utils.py:135: UserWarning: Using 'weights' as positional parameter(s) is deprecated since 0.13 and may be removed in the future. Please use keyword parameter(s) instead.
  warnings.warn(
/home/sunzhenyu/anaconda3/envs/mvgs/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

[ITER 500] Evaluating test: L1 0.011547612957656384 PSNR 30.531153678894043

[ITER 500] Evaluating train: L1 0.015594610758125783 PSNR 29.180429840087893

[ITER 500] Saving Gaussians
Training progress:  12%|███████████                                                                                 | 600/5000 [02:19<14:22,  5.10it/s, Loss=0.0219071]/home/sunzhenyu/Projects/MVGS/scene/gaussian_model.py:420: UserWarning: Using torch.cross without specifying the dim arg is deprecated.
Please either pass the dim explicitly or simply use torch.linalg.cross.
The default value of dim will change to agree with that of linalg.cross in a future release. (Triggered internally at ../aten/src/ATen/native/Cross.cpp:62.)
  cross_dir = torch.cross(ray1_dir, ray2_dir)
Training progress:  30%|███████████████████████████▎                                                               | 1500/5000 [05:27<11:22,  5.13it/s, Loss=0.0089671]
Saved rendered image for camera 0 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_0.png
Saved rendered image for camera 1 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_1.png
Saved rendered image for camera 2 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_2.png
Saved rendered image for camera 3 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_3.png
Saved rendered image for camera 4 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_4.png
Saved rendered image for camera 5 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_5.png
Saved rendered image for camera 6 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_6.png
Saved rendered image for camera 7 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_7.png
Saved rendered image for camera 8 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_8.png
Saved rendered image for camera 9 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_9.png
Saved rendered image for camera 10 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_10.png
Saved rendered image for camera 11 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_11.png
Saved rendered image for camera 12 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_12.png
Saved rendered image for camera 13 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_13.png
Saved rendered image for camera 14 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_14.png
Saved rendered image for camera 15 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_15.png
Saved rendered image for camera 16 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_16.png
Saved rendered image for camera 17 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_17.png
Saved rendered image for camera 18 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_18.png
Saved rendered image for camera 19 at iteration 1000 to rendered_images/bathroom/iteration_1000/rendered_image_19.png
increase sh degree
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 1000] Evaluating test: L1 0.007092552492395043 PSNR 34.99985885620117

[ITER 1000] Evaluating train: L1 0.009773946553468705 PSNR 32.99206047058106

[ITER 1000] Saving Gaussians
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 1500] Evaluating test: L1 0.004943094681948423 PSNR 38.39414024353027

[ITER 1500] Evaluating train: L1 0.006364953611046076 PSNR 36.2077392578125

[ITER 1500] Saving Gaussians
Saved rendered image for camera 0 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_0.png
Saved rendered image for camera 1 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_1.png
Saved rendered image for camera 2 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_2.png
Saved rendered image for camera 3 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_3.png
Saved rendered image for camera 4 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_4.png
Saved rendered image for camera 5 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_5.png
Saved rendered image for camera 6 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_6.png
Saved rendered image for camera 7 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_7.png
Saved rendered image for camera 8 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_8.png
Saved rendered image for camera 9 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_9.png
Saved rendered image for camera 10 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_10.png
Saved rendered image for camera 11 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_11.png
Saved rendered image for camera 12 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_12.png
Saved rendered image for camera 13 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_13.png
Saved rendered image for camera 14 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_14.png
Saved rendered image for camera 15 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_15.png
Saved rendered image for camera 16 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_16.png
Saved rendered image for camera 17 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_17.png
Saved rendered image for camera 18 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_18.png
Saved rendered image for camera 19 at iteration 2000 to rendered_images/bathroom/iteration_2000/rendered_image_19.png
increase sh degree
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 2000] Evaluating test: L1 0.004219192545861006 PSNR 39.22190475463867

[ITER 2000] Evaluating train: L1 0.005093093402683735 PSNR 38.18006439208985

[ITER 2000] Saving Gaussians
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 2500] Evaluating test: L1 0.0034975691232830286 PSNR 40.8437385559082

[ITER 2500] Evaluating train: L1 0.004163105366751552 PSNR 39.761817169189456

[ITER 2500] Saving Gaussians
Saved rendered image for camera 0 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_0.png
Saved rendered image for camera 1 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_1.png
Saved rendered image for camera 2 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_2.png
Saved rendered image for camera 3 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_3.png
Saved rendered image for camera 4 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_4.png
Saved rendered image for camera 5 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_5.png
Saved rendered image for camera 6 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_6.png
Saved rendered image for camera 7 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_7.png
Saved rendered image for camera 8 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_8.png
Saved rendered image for camera 9 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_9.png
Saved rendered image for camera 10 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_10.png
Saved rendered image for camera 11 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_11.png
Saved rendered image for camera 12 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_12.png
Saved rendered image for camera 13 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_13.png
Saved rendered image for camera 14 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_14.png
Saved rendered image for camera 15 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_15.png
Saved rendered image for camera 16 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_16.png
Saved rendered image for camera 17 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_17.png
Saved rendered image for camera 18 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_18.png
Saved rendered image for camera 19 at iteration 3000 to rendered_images/bathroom/iteration_3000/rendered_image_19.png
increase sh degree
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 3000] Evaluating test: L1 0.0034233557526022196 PSNR 41.00186538696289

[ITER 3000] Evaluating train: L1 0.003756322991102934 PSNR 40.535437774658206

[ITER 3000] Saving Gaussians
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 3500] Evaluating test: L1 0.46479563415050507 PSNR 5.6877524852752686

[ITER 3500] Evaluating train: L1 0.43854221105575564 PSNR 6.081412029266358

[ITER 3500] Saving Gaussians
Saved rendered image for camera 0 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_0.png
Saved rendered image for camera 1 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_1.png
Saved rendered image for camera 2 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_2.png
Saved rendered image for camera 3 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_3.png
Saved rendered image for camera 4 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_4.png
Saved rendered image for camera 5 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_5.png
Saved rendered image for camera 6 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_6.png
Saved rendered image for camera 7 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_7.png
Saved rendered image for camera 8 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_8.png
Saved rendered image for camera 9 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_9.png
Saved rendered image for camera 10 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_10.png
Saved rendered image for camera 11 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_11.png
Saved rendered image for camera 12 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_12.png
Saved rendered image for camera 13 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_13.png
Saved rendered image for camera 14 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_14.png
Saved rendered image for camera 15 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_15.png
Saved rendered image for camera 16 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_16.png
Saved rendered image for camera 17 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_17.png
Saved rendered image for camera 18 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_18.png
Saved rendered image for camera 19 at iteration 4000 to rendered_images/bathroom/iteration_4000/rendered_image_19.png
increase sh degree
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 4000] Evaluating test: L1 0.4813699573278427 PSNR 5.483769655227661

[ITER 4000] Evaluating train: L1 0.4623490393161774 PSNR 5.77550392150879

[ITER 4000] Saving Gaussians
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 4500] Evaluating test: L1 0.4857836961746216 PSNR 5.433297634124756

[ITER 4500] Evaluating train: L1 0.46943046450614934 PSNR 5.676762866973878

[ITER 4500] Saving Gaussians
Saved rendered image for camera 0 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_0.png
Saved rendered image for camera 1 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_1.png
Saved rendered image for camera 2 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_2.png
Saved rendered image for camera 3 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_3.png
Saved rendered image for camera 4 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_4.png
Saved rendered image for camera 5 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_5.png
Saved rendered image for camera 6 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_6.png
Saved rendered image for camera 7 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_7.png
Saved rendered image for camera 8 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_8.png
Saved rendered image for camera 9 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_9.png
Saved rendered image for camera 10 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_10.png
Saved rendered image for camera 11 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_11.png
Saved rendered image for camera 12 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_12.png
Saved rendered image for camera 13 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_13.png
Saved rendered image for camera 14 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_14.png
Saved rendered image for camera 15 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_15.png
Saved rendered image for camera 16 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_16.png
Saved rendered image for camera 17 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_17.png
Saved rendered image for camera 18 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_18.png
Saved rendered image for camera 19 at iteration 5000 to rendered_images/bathroom/iteration_5000/rendered_image_19.png
increase sh degree
ATE tensor(1.1655e-16, dtype=torch.float64)

[ITER 5000] Evaluating test: L1 0.48905049264431 PSNR 5.398570775985718

[ITER 5000] Evaluating train: L1 0.47452157735824585 PSNR 5.613128948211671

[ITER 5000] Saving Gaussians

Training complete.
